<VirtualHost *:80>
        ServerName flex.io
        ServerAlias flex.io
        ServerAdmin admin@flex.io

#ProxyPass / http://z.flex.io/ retry=0
#ProxyPassReverse / http://z.flex.io/

RewriteEngine On
RewriteCond %{HTTP_HOST} ^flex.io$
RewriteRule ^ https://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

#RewriteCond %{HTTPS} off
#RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L]
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^.*$ https://%{HTTP_HOST}%{REQUEST_URI}

<LocationMatch "/(myindex.html|wp-.*|xmlrpc.php.*|sendy.*|admin.*|about/?$|blog.*|beta-sign-up/?$|request-a-demo/?$|pricing/?$|product/?$|feed.*|privacy/?$|terms/?$|www-fonts.*|.*sitemap.*)">
    ProxyPass http://z.flex.io/$1
    ProxyPassReverse http://z.flex.io/$1
</LocationMatch>

        TimeOut 36000
#        AddOutputFilterByType DEFLATE text/html text/css text/plain text/xml application/x-javascript application/javascript text/javascript

        DocumentRoot /srv/www/flexio/src/public

        <Directory />
            Options FollowSymLinks
            AllowOverride None
        </Directory>

        <Directory /srv/www/flexio/src/public>
            Options Indexes FollowSymLinks
            AllowOverride All
            Require all granted
        </Directory>

        ErrorLog /srv/www/flexio/log/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn 

        CustomLog /srv/www/flexio/log/access.log combined
        ServerSignature On
</VirtualHost>

