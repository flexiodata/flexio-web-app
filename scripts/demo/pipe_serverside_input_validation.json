{
    "eid_type": "PIP",
    "name": "example-serverside-input-validation",
    "title": "Example: Server-side Input Validation",
    "description": "Validate input with a server-side logic that hides data used to validate with Python Cerberus",
    "task": {
        "op": "sequence",
        "items": [
            {
                "op": "execute",
                "lang": "python",
                "code": "CiMgdmFsaWRhdGUgZm9ybS1kYXRhIFBPU1QgcGFyYW1ldGVyczoKIyAgICAgdXNlcm5hbWU6IG11c3QgYWxwaGFudW1lcmljLCBldGMsIGFuZCBub3QgYmUgdGFrZW4gKGUuZy4gZmxleGlvKSBvciBhIHJlc2VydmVkL2lsbGVnYWwgd29yZAojICAgICBsYXN0bmFtZTogbXVzdCBiZSBhIHN0cmluZyBvZiBhdCBsZWFzdCB0d28gY2hhcmFjdGVycwojICAgICBmaXJzdG5hbWU6IG11c3QgYmUgYSBzdHJpbmcgb2YgYXQgbGVhc3QgdHdvIGNoYXJhY3RlcnMKIyBjYWxsaW5nIGNsaWVudHMgc2hvdWxkIGFsc28gcGVyZm9ybSBiYXNpYyB2YWxpZGF0aW9uLCBidXQKIyBzZXJ2ZXItc2lkZSB2YWxpZGF0aW9uIGlzIHBhcnRpY3VsYXJseSB1c2VmdWwgd2hlbiBpbnB1dHMgbWF5CiMgY29tZSBmcm9tIGRpZmZlcmVudCBwbGFjZXMgKGUuZy4gQVBJIGNhbGwpIG9yIHdoZW4gY2VydGFpbiBpbmZvcm1hdGlvbgojIHNob3VsZG4ndCBiZSBleHBvc2VkIChlLmcuIGxpc3Qgb2YgdXNlcm5hbWVzIG5lZWRlZCB0byBkZXRlcm1pbmUgaWYgYSB1c2VybmFtZQojIGlzIGFscmVhZHkgdGFrZW4KCiMgdXNlIGNlcmJlcnVzIHB5dGhvbiBsaWJyYXJ5IGZvciB2YWxpZGF0aW9uOgojIGh0dHBzOi8vZ2l0aHViLmNvbS9weWV2ZS9jZXJiZXJ1cwojIGh0dHA6Ly9kb2NzLnB5dGhvbi1jZXJiZXJ1cy5vcmcvZW4vc3RhYmxlLwoKCmltcG9ydCByZQpmcm9tIGNlcmJlcnVzIGltcG9ydCBWYWxpZGF0b3IKCmRlZiBmbGV4aW9faGFuZGxlcihjb250ZXh0KToKCiAgICAjIGNyZWF0ZSBhIHZhbGlkYXRvciB3aXRoIHRoZSBkZXNpcmVkIGNoZWNrcwogICAgdiA9IFZhbGlkYXRvcih7CiAgICAgICAgJ3VzZXJuYW1lJzogIHsncmVxdWlyZWQnOiBUcnVlLCAndmFsaWRhdG9yJzogdmFsaWRhdGVfdXNlcm5hbWV9LCAjIGN1c3RvbSB2YWxpZGF0b3IKICAgICAgICAnZmlyc3RuYW1lJzogeydyZXF1aXJlZCc6IFRydWUsICd0eXBlJzogJ3N0cmluZycsICdtaW5sZW5ndGgnOiAyfSwKICAgICAgICAnbGFzdG5hbWUnOiAgeydyZXF1aXJlZCc6IFRydWUsICd0eXBlJzogJ3N0cmluZycsICdtaW5sZW5ndGgnOiAyfQogICAgfSkKCiAgICAjIHZhbGlkYXRlIHRoZSBmb3JtLWRhdGEgUE9TVGVkIHRvIHRoZSBwaXBlIHdoZW4gY2FsbGluZwogICAgIyB0aGUgcGlwZS86aWQvcnVuIEFQSSBlbmRwb2ludDsgdGhlc2UgYXJlIHBhc3NlZCBpbiB0aGUKICAgICMgaGFuZGxlciBhcyBhIGRpY3Rpb25hcnkgaW4gdGhlICdjb250ZXh0LmZvcm0nIHBhcmFtZXRlcgogICAgIyBub3RlOiBmb3IgdGVzdGluZyBwdXJwb3NlcywgdGhlIHBpcGUgY2FuIGJlIHRlc3RlZCB3aXRoCiAgICAjIFBPU1QgaW5wdXRzIGJ5IHNldHRpbmcgdGhlIGtleS92YWx1ZSBpbiB0aGUgaW5wdXQgYXJlYQogICAgIyBhYm92ZSBhbmQgdGhlbiBwcmVzc2luZyB0aGUgVEVTVCBidXR0b24KICAgIGlmICh2LnZhbGlkYXRlKGNvbnRleHQuZm9ybSkgaXMgRmFsc2UpOgogICAgICAgIGNvbnRleHQub3V0cHV0LndyaXRlKHsKICAgICAgICAgICAgInN1Y2Nlc3MiOiBGYWxzZSwKICAgICAgICAgICAgImVycm9ycyI6IHYuZXJyb3JzICAgICAgICAgIAogICAgICAgIH0pCiAgICAgICAgcmV0dXJuCgogICAgY29udGV4dC5vdXRwdXQud3JpdGUoewogICAgICAgICJzdWNjZXNzIjogVHJ1ZSwKICAgICAgICAicGFyYW1zIjogY29udGV4dC5mb3JtICAgICAgCiAgICB9KQoKZGVmIHZhbGlkYXRlX3VzZXJuYW1lKGZpZWxkLCB2YWx1ZSwgZXJyb3IpOgogIAogICAgIyBtYWtlIHN1cmUgdGhlIHVzZXJuYW1lIHN0YXJ0cyB3aXRoIGEgbG93ZXJjYXNlIGxldHRlciwgaXMKICAgICMgYWxwaGFudW1lcmljLCBhbmQgYmV0d2VlbiAzIGFuZCA4MCBjaGFyYWN0ZXJzCiAgICBwYXR0ZXJuID0gcmUuY29tcGlsZSgnXlthLXpdW2EtejAtOV17Miw3OX0kJykKICAgIGlmIChwYXR0ZXJuLm1hdGNoKHZhbHVlKSBpcyBOb25lKToKICAgICAgICBlcnJvcihmaWVsZCwgIm11c3Qgc3RhcnQgd2l0aCBhIGxvd2VyY2FzZSBsZXR0ZXIsIGJlIGFscGhhbnVtZXJpYywgYW5kIGhhdmUgYmV0d2VlbiAzIGFuZCA4MCBjaGFyYWN0ZXJzIikgICAgICAgIAogIAogICAgIyBtYWtlIHN1cmUgdGhlIHVzZXJuYW1lIGlzbid0IGFscmVhZHkgdGFrZW4KICAgIHdvcmRzID0gWydmbGV4aW8nXQogICAgaWYgYW55KHZhbHVlIGluIHcgZm9yIHcgaW4gd29yZHMpOgogICAgICAgIGVycm9yKGZpZWxkLCAiaXMgYWxyZWFkeSBpbiB1c2UiKSAgICAgIAogICAgCiAgICAjIG1ha2Ugc3VyZSB0aGUgdXNlcm5hbWUgaXNuJ3QgYSByZXNlcnZlZC9pbGxlZ2FsIHdvcmQKICAgIHdvcmRzID0gWyd1c2VybmFtZScsICdwYXNzd29yZCcsICd0ZXN0JywgJ3VzZXInLCdudWxsJywKICAgICAgICAgICAgICd0cnVlJywgJ2ZhbHNlJywgJ2FkbWluJywgJ2FkbWluaXN0cmF0b3InXQogICAgaWYgYW55KHZhbHVlIGluIHcgZm9yIHcgaW4gd29yZHMpOgogICAgICAgIGVycm9yKGZpZWxkLCAibXVzdCBub3QgYmUgYSByZXNlcnZlZC9pbGxlZ2FsIHdvcmQiKSAgICAgICAgICAgICAgCgo="
            }
        ]
    }
}
