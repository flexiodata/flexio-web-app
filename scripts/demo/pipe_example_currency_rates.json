{
    "eid_type": "PIP",
    "name": "example-currency-rates",
    "title": "Currency Rates",
    "description": "Lists the currency exchange rates for a particular currency and date",
    "deploy_mode": "R",
    "deploy_api": "A",
    "deploy_schedule": "I",
    "deploy_email": "I",
    "deploy_ui": "I",
    "examples": [
        "\"USD\"",
        "\"EUR\", \"2018-12-31\"",
        "A1, B1"
    ],
    "params": [
        {
            "name": "cur",
            "type": "string",
            "description": "The currency type to use as the base",
            "required": true
        },
        {
            "name": "date",
            "type": "date",
            "description": "The exchange rate date in YYYY-DD-MM format",
            "required": false
        }
    ],
    "notes": "This function uses the https://exchangeratesapi.io API to list the rates.\n\nThe following currency types are allowed: CAD, HKD, ISK, PHP, DKK, HUF, CZK, GBP, RON, SEK, IDR, INR, BRL, RUB, HRK, JPY, THB, CHF, EUR, MYR, BGN, TRY, CNY, NOK, NZD, ZAR, USD, MXN, SGD, AUD, ILS, KRW, PLN",
    "task": {
        "op": "sequence",
        "items": [
            {
                "op": "execute",
                "lang": "python",
                "code": "CiMgLS0tCiMgbmFtZTogY3VycmVuY3ktcmF0ZXMKIyBkZXBsb3llZDogdHJ1ZQojIHRpdGxlOiBDdXJyZW5jeSBSYXRlcwojIGRlc2NyaXB0aW9uOiBMaXN0cyB0aGUgY3VycmVuY3kgZXhjaGFuZ2UgcmF0ZXMgZm9yIGEgcGFydGljdWxhciBjdXJyZW5jeSBhbmQgZGF0ZQojIHBhcmFtczoKIyAtIG5hbWU6IGN1cgojICAgdHlwZTogc3RyaW5nCiMgICBkZXNjcmlwdGlvbjogVGhlIGN1cnJlbmN5IHR5cGUgdG8gdXNlIGFzIHRoZSBiYXNlCiMgICByZXF1aXJlZDogdHJ1ZQojIC0gbmFtZTogZGF0ZQojICAgdHlwZTogZGF0ZQojICAgZGVzY3JpcHRpb246IFRoZSBleGNoYW5nZSByYXRlIGRhdGUgaW4gWVlZWS1ERC1NTSBmb3JtYXQKIyAgIHJlcXVpcmVkOiBmYWxzZQojIGV4YW1wbGVzOgojIC0gIlwiVVNEXCIiCiMgLSAiXCJFVVJcIiwgXCIyMDE4LTEyLTMxXCIiCiMgLSBBMSwgQjEKIyBub3RlczogfC0KIyAgIFRoaXMgZnVuY3Rpb24gdXNlcyB0aGUgaHR0cHM6Ly9leGNoYW5nZXJhdGVzYXBpLmlvIEFQSSB0byBsaXN0IHRoZSByYXRlcy4KIwojICAgVGhlIGZvbGxvd2luZyBjdXJyZW5jeSB0eXBlcyBhcmUgYWxsb3dlZDogQ0FELCBIS0QsIElTSywgUEhQLCBES0ssIEhVRiwgQ1pLLCBHQlAsIFJPTiwgU0VLLCBJRFIsIElOUiwgQlJMLCBSVUIsIEhSSywgSlBZLCBUSEIsIENIRiwgRVVSLCBNWVIsIEJHTiwgVFJZLCBDTlksIE5PSywgTlpELCBaQVIsIFVTRCwgTVhOLCBTR0QsIEFVRCwgSUxTLCBLUlcsIFBMTgojIC0tLQoKCmltcG9ydCBqc29uCmltcG9ydCByZXF1ZXN0cwpmcm9tIGRhdGV0aW1lIGltcG9ydCAqCmZyb20gY2VyYmVydXMgaW1wb3J0IFZhbGlkYXRvcgpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBPcmRlcmVkRGljdApmcm9tIG9wZXJhdG9yIGltcG9ydCBpdGVtZ2V0dGVyCgojIG1haW4gZnVuY3Rpb24gZW50cnkgcG9pbnQKZGVmIGZsZXhpb19oYW5kbGVyKGZsZXgpOgogICAgcmVzdWx0ID0gZ2V0cmVzdWx0KGZsZXgpCiAgICBmbGV4Lm91dHB1dC53cml0ZShyZXN1bHQpCgpkZWYgZ2V0cmVzdWx0KGZsZXgpOgoKICAgICMgZ2V0IHRoZSBpbnB1dAogICAgaW5wdXQgPSBmbGV4LmlucHV0LnJlYWQoKQogICAgdHJ5OgogICAgICAgIGlucHV0ID0ganNvbi5sb2FkcyhpbnB1dCkKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShpbnB1dCwgbGlzdCk6IHJhaXNlIFZhbHVlRXJyb3IKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IKCiAgICAjIGRlZmluZSB0aGUgZXhwZWN0ZWQgcGFyYW1ldGVycyBhbmQgbWFwIHRoZSB2YWx1ZXMgdG8gdGhlIHBhcmFtZXRlciBuYW1lcwogICAgIyBiYXNlZCBvbiB0aGUgcG9zaXRpb25zIG9mIHRoZSBrZXlzL3ZhbHVlcwogICAgcGFyYW1zID0gT3JkZXJlZERpY3QoKQogICAgcGFyYW1zWydjdXInXSA9IHsncmVxdWlyZWQnOiBUcnVlLCAndmFsaWRhdG9yJzogdmFsaWRhdGVfY3VycmVuY3ksICdjb2VyY2UnOiBsYW1iZGEgczogcy51cHBlcigpfQogICAgcGFyYW1zWydkYXRlJ10gPSB7J3JlcXVpcmVkJzogRmFsc2UsICd0eXBlJzogJ2RhdGUnLCAnY29lcmNlJzogbGFtYmRhIHM6IGRhdGV0aW1lLnN0cnB0aW1lKHMsICclWS0lbS0lZCcpfQogICAgaW5wdXQgPSBkaWN0KHppcChwYXJhbXMua2V5cygpLCBpbnB1dCkpCgogICAgIyB2YWxpZGF0ZSB0aGUgbWFwcGVkIGlucHV0IGFnYWluc3QgdGhlIHZhbGlkYXRvcgogICAgIyBpZiB0aGUgaW5wdXQgaXMgdmFsaWQgcmV0dXJuIGFuIGVycm9yCiAgICB2ID0gVmFsaWRhdG9yKHBhcmFtcywgYWxsb3dfdW5rbm93biA9IFRydWUpCiAgICBpbnB1dCA9IHYudmFsaWRhdGVkKGlucHV0KQogICAgaWYgaW5wdXQgaXMgTm9uZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yCgogICAgdHJ5OgoKICAgICAgICBkYXRlID0gJ2xhdGVzdCc7CiAgICAgICAgaWYgJ2RhdGUnIGluIGlucHV0LmtleXMoKToKICAgICAgICAgICAgZGF0ZSA9IGlucHV0WydkYXRlJ10uc3RyZnRpbWUoJyVZLSVtLSVkJykKCiAgICAgICAgdXJsID0gJ2h0dHBzOi8vYXBpLmV4Y2hhbmdlcmF0ZXNhcGkuaW8vJytkYXRlKyc/YmFzZT0nICsgaW5wdXRbJ2N1ciddCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsKQogICAgICAgIHJhdGVzID0gcmVzcG9uc2UuanNvbigpWydyYXRlcyddCgogICAgICAgIGl0ZW1zID0gbGlzdCgpCiAgICAgICAgZm9yIGN1cnJlbmN5LCBhbW91bnQgaW4gcmF0ZXMuaXRlbXMoKToKICAgICAgICAgICAgaXRlbXMuYXBwZW5kKFtjdXJyZW5jeSwgYW1vdW50XSkKICAgICAgICBpdGVtcyA9IHNvcnRlZChpdGVtcywga2V5PWl0ZW1nZXR0ZXIoMCkpCgogICAgICAgIHJlc3VsdCA9IFtbJ2N1cnJlbmN5JywnYW1vdW50J11dCiAgICAgICAgcmVzdWx0LmV4dGVuZChpdGVtcykKICAgICAgICBmbGV4Lm91dHB1dC53cml0ZShyZXN1bHQpCgogICAgZXhjZXB0OgogICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcgoKCmRlZiB2YWxpZGF0ZV9jdXJyZW5jeShmaWVsZCwgdmFsdWUsIGVycm9yKToKCiAgICBjdXJyZW5jeV90eXBlcyA9IFsKICAgICAgICAnQ0FEJywnSEtEJywnSVNLJywnUEhQJywnREtLJywnSFVGJywnQ1pLJywnR0JQJywnUk9OJywnU0VLJywKICAgICAgICAnSURSJywnSU5SJywnQlJMJywnUlVCJywnSFJLJywnSlBZJywnVEhCJywnQ0hGJywnRVVSJywnTVlSJywKICAgICAgICAnQkdOJywnVFJZJywnQ05ZJywnTk9LJywnTlpEJywnWkFSJywnVVNEJywnTVhOJywnU0dEJywnQVVEJywKICAgICAgICAnSUxTJywnS1JXJywnUExOJwogICAgXQogICAgaWYgYW55KHZhbHVlIGluIGMgZm9yIGMgaW4gY3VycmVuY3lfdHlwZXMpOgogICAgICAgIHJldHVybgoKICAgIGVycm9yKGZpZWxkLCAnaXMgYW4gaW52YWxpZCBjdXJyZW5jeSB0eXBlJyk="
            }
        ]
    }
}
